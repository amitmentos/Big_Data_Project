# MinIO / S3 Configuration for Spark

# Basic S3A configuration
spark.hadoop.fs.s3a.impl                            org.apache.hadoop.fs.s3a.S3AFileSystem
spark.hadoop.fs.s3a.path.style.access               true
spark.hadoop.fs.s3a.connection.ssl.enabled          false

# Endpoint configuration
spark.hadoop.fs.s3a.endpoint                        http://minio:9000
spark.hadoop.fs.s3a.access.key                      minio
spark.hadoop.fs.s3a.secret.key                      minio123

# Connection tuning
spark.hadoop.fs.s3a.connection.establish.timeout    5000
spark.hadoop.fs.s3a.connection.timeout              10000
spark.hadoop.fs.s3a.attempts.maximum                10
spark.hadoop.fs.s3a.retry.limit                     10
spark.hadoop.fs.s3a.retry.interval                  1000

# Performance optimization
spark.hadoop.fs.s3a.fast.upload                     true
spark.hadoop.fs.s3a.multipart.size                  67108864
spark.hadoop.fs.s3a.threads.max                     20
spark.hadoop.fs.s3a.max.connections                 100
spark.hadoop.fs.s3a.connection.maximum              100

# MetaStore configuration
spark.sql.catalog.spark_catalog                     org.apache.iceberg.spark.SparkSessionCatalog
spark.sql.catalog.spark_catalog.type                hadoop
spark.sql.catalog.spark_catalog.warehouse           s3a://warehouse/
spark.sql.catalog.spark_catalog.s3.endpoint         http://minio:9000
# Note: io-impl requires AWS SDK v2, which is included in iceberg-spark-runtime jar
# spark.sql.catalog.spark_catalog.io-impl             org.apache.iceberg.aws.s3.S3FileIO 